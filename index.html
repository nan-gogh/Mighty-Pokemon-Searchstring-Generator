<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mächtiger Suchstring</title>
  <link rel="icon" href="./mighty_mark_go.svg" type="image/svg+xml" />
  <link rel="shortcut icon" href="./mighty_mark_go.svg" />
<style>
:root{
  --color-bg-dark-teal: #12251d;
  --color-bg-charcoal: #0f1011;
  --color-lime-bright: #d5ff9a;
  --color-teal-primary: #61C497;
  --color-charcoal-dark: #1a1b1c;
  --color-border-subtle: rgba(255,255,255,0.03);
  --color-focus-blue: rgba(78, 144, 254, 0.12);
  --header-control-effective: clamp(min(140px, 95vw), 85vw, 300px);
  --radius: 999px;
  --transition-smooth: 520ms cubic-bezier(.2,0,.2,1);
  --transition-fast: 120ms ease;
}

html{box-sizing:border-box}
*,*::before,*::after{box-sizing:inherit}

html,body{
  height:100%;
  margin:0;
  font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
}

body{
  background:var(--color-bg-dark-teal);
  color:var(--color-teal-primary);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  position:relative;
  z-index:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  padding:clamp(12px, 3vw, 28px);
  box-sizing:border-box;
}

body::before{
  content: "";
  position:fixed;
  inset:0;
  background-image: url('./young_will.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0.15;
  pointer-events: none;
  z-index: 0;
  mix-blend-mode: overlay;
  -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,0.0), rgba(0,0,0,1));
  mask-image: linear-gradient(to bottom, rgba(0,0,0,0.0), rgba(0,0,0,1));
}

body > *{position:relative;z-index:1}

header{
  background: transparent;
  color:var(--color-teal-primary); 
  padding:clamp(8px, 2.5vw, 18px) clamp(12px, 3vw, 22px) clamp(4px, 1vw, 6px) clamp(12px, 3vw, 22px);
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:clamp(6px, 2vw, 10px);
  position:relative;
  width:100%;
  max-width:min(980px, 95vw);
}

header img{
  width: var(--header-control-effective);
  height: auto;
  flex: 0 0 auto;
  max-width: 92vw;
  object-fit: contain;
  border-radius:0;
}

.header-actions{
  display:flex;
  flex-direction:column;
  gap:clamp(6px, 1.5vw, 8px);
  align-items:center;
  justify-content:center;
  margin-top:clamp(4px, 1vw, 6px);
  position:relative;
  width:100%;
}

.header-actions .btn{
  padding:clamp(8px, 2vw, 10px) clamp(14px, 3vw, 18px);
  border-radius:var(--radius);
  min-width: var(--header-control-effective);
  max-width:100%;
}

h1{
  margin:0;
  /* scale the heading with the header control token so it visually spans the image width */
  font-size: clamp(12px, calc(var(--header-control-effective) * 0.09), 40px);
  font-weight:600;
  text-align:center;
  white-space: nowrap; 
  overflow: hidden; 
  /*text-overflow: ellipsis;*/
  /* match the image width token so the heading aligns to the same visual width */
  width: var(--header-control-effective);
  max-width: 100%;
  box-sizing:border-box;
  align-self:center;
  padding:0 clamp(8px, 2vw, 12px);
  line-height:1.05;
}

header h1:first-of-type{
  /* slightly smaller primary header scale to avoid oversized headings */
  font-size: clamp(16px, calc(var(--header-control-effective) * 0.105), 48px);
  margin-bottom:clamp(4px, 1vw, 6px);
}

header h2{
  font-size:clamp(16px, 4.5vw, 36px);
  margin:0 auto;
  font-weight:600;
  color:var(--color-teal-primary);
  text-align:center;
  width:100%;
  max-width:var(--header-control-effective);
  box-sizing:border-box;
  line-height:1.2;
}

.p-muted{
  color:var(--color-teal-primary);
  margin:0 0 clamp(6px, 1.5vw, 8px) 0;
  font-size:clamp(0.85rem, 2vw, 0.95rem);
}

.p-muted.small{
  display:block;
  width:100%;
  max-width:var(--header-control-effective);
  margin:clamp(8px, 2vw, 12px) auto 0;
  text-align:center;
  font-size: clamp(11px, 2.5vw, 14px);
  line-height: 1.4;
  padding:0 clamp(8px, 2vw, 12px);
}

.card{
  background:var(--color-lime-bright);
  border-radius:clamp(20px, 4vw, 25px);
  padding:clamp(40px, 4vw, 35px) clamp(12px, 3vw, 18px) clamp(12px, 3vw, 18px) clamp(12px, 3vw, 18px);
  margin-bottom:clamp(10px, 2.5vw, 16px);
  margin-top:clamp(-47px, -8vw, -50px);
  border:none;
  position:relative;
  z-index:1;
  width: 100%;
  width: var(--header-control-effective);
  max-width: 100%;
  margin-left: auto;
  margin-right: auto;
  max-height: 1200px;
  overflow: visible;
  opacity: 1;
  transform: translateY(0);
  transition: max-height var(--transition-smooth), opacity 420ms ease, transform 420ms ease, padding 420ms ease, margin 420ms ease;
  will-change: transform;
}

textarea{
  width:100%;
  min-height:clamp(140px, 30vw, 220px);
  max-height:clamp(50vh, 70vh, 80vh);
  /* symmetric vertical / horizontal padding to avoid visual horizontal shift on narrow screens */
  padding: 0;
  margin-top: clamp(12px, 3vw, 20px);
  margin-left: clamp(2px, 3vw, 5px);
  border:none;
  background:var(--color-lime-bright);
  color:var(--color-teal-primary);
  font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
  font-size:clamp(11px, 2vw, 13px);
  resize:none;
  white-space:pre-wrap;
  word-break:break-word;
  overflow:auto;
  overflow-wrap: anywhere;
  scrollbar-width: thin;
  scrollbar-color: transparent transparent;
}

textarea:focus{
  outline:none;
  box-shadow:none;
}

textarea::-webkit-scrollbar{
  width:clamp(12px, 3vw, 24px);
  height:clamp(8px, 2vw, 12px);
  background:transparent;
}

textarea::-webkit-scrollbar-track{
  background: transparent;
}

textarea::-webkit-scrollbar-thumb{
  background: var(--color-teal-primary);
  border:none;
  opacity:0;
  transition:opacity 420ms ease, background-color 320ms ease;
}

.card:hover textarea::-webkit-scrollbar-thumb,textarea:focus::-webkit-scrollbar-thumb{
  opacity:1;
  background: var(--color-teal-primary);
}
.card:hover textarea{
  scrollbar-color: var(--color-teal-primary) transparent;
}

.btn{
  background: var(--color-teal-primary);
  color: var(--color-lime-bright);
  padding:clamp(8px, 2vw, 10px) clamp(12px, 2.5vw, 14px);
  border-radius:var(--radius);
  border:none;
  font-weight:600;
  font-size:clamp(0.85rem, 2vw, 1rem);
  cursor:pointer;
  transition:transform var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast), color var(--transition-fast);
  box-shadow:none;
  will-change: transform;
  transform-origin:center;
}

.btn:hover{
  transform:scale(1.02);
  box-shadow:0 10px 28px rgba(0,0,0,0.30);
}

.btn:focus{
  /* remove the visible blue outline on mouse/click focus to match clipboard button */
  outline: none;
}

/* keep an accessible focus indicator for keyboard users */
.btn:focus-visible{
  /* per request: no outline even for focus-visible */
  outline: none;
}

/* provide a brief click/press animation so share/info buttons respond visually */
.btn:active{
  animation: btn-press 220ms ease-out;
  transform-origin: center;
  will-change: transform;
}

.btn[disabled],.btn:disabled{
  cursor:not-allowed;
  pointer-events:none;
  color:rgba(255,255,255,0.85);
}

.btn.success{
  background:#2b8a3e;
  color:white;
  border:none;
  transform-origin:center;
  animation:btn-pulse 360ms ease-out 1;
}

.btn.error{
  background:#8a2b2b;
  color:white;
  border-color:rgba(255,255,255,0.06);
}

/* clipboard button grouped with primary button rules */
.btn-clipboard{
  background: var(--color-teal-primary);
  color: var(--color-lime-bright);
  padding:clamp(12px, 3vw, 16px) clamp(20px, 4vw, 28px);
  font-weight: 600;
  font-size:clamp(0.95rem, 2.5vw, 1.12rem);
  cursor: pointer;
  /* sizing matches `.header-actions .btn` so it adapts the same on narrow screens */
  min-width: var(--header-control-effective);
  max-width: 100%;
  width: auto;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  border-radius:var(--radius);
  border:none;
  position:relative;
  z-index:10;
}

.btn-clipboard.success{
  background: rgb(213, 255, 154);
  color: var(--color-teal-primary);
  min-width: var(--header-control-effective);
  max-width: 100%;
  border:none;
  animation: btn-pulse 400ms ease-out 1, btn-glow 400ms ease-out 1;
}

.btn-clipboard:hover{
  box-shadow: 0 18px 50px rgba(213,255,154,0.16), 0 6px 18px rgba(213,255,154,0.08);
  transform: scale(1.02);
}

#mode-info{
  position:absolute;
  z-index:50;
  background:var(--color-bg-charcoal);
  color:var(--color-teal-primary);
  border:none;
  padding:clamp(12px, 2.5vw, 14px);
  border-radius:clamp(15px, 4vw, 25px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.55);
  width:100%;
  max-width:min(var(--header-control-effective), 92vw);
  word-break:normal;
  text-align: center;
  font-size:clamp(0.8rem, 2vw, 0.9rem);
  line-height:1.5;
  left:50%;
  top:0;
  transform:translateX(-50%) translateY(-6px) scale(.98);
  opacity:0;
  visibility:hidden;
  pointer-events:none;
  transition:opacity 200ms ease, transform 220ms cubic-bezier(.2,0,.2,1), visibility 200ms;
}

#mode-info.open{
  opacity:1;
  transform:translateX(-50%) translateY(0) scale(1);
  visibility:visible;
  pointer-events:auto;
}

@keyframes btn-pulse{
  0%{transform:scale(1);box-shadow:0 6px 18px rgba(43,138,62,0.06)}
  50%{transform:scale(1.06);box-shadow:0 12px 30px rgba(43,138,62,0.14)}
  100%{transform:scale(1);box-shadow:0 6px 18px rgba(43,138,62,0.06)}
}

@keyframes btn-glow{
  0%{ box-shadow: 0 8px 22px rgba(213, 255, 154,0.10), 0 0 0 rgba(213, 255, 154,0); }
  30%{ box-shadow: 0 26px 72px rgba(213, 255, 154,0.30), 0 0 60px rgba(213, 255, 154,0.24); }
  60%{ box-shadow: 0 36px 110px rgba(213, 255, 154,0.40), 0 0 90px rgba(213, 255, 154,0.32); }
  100%{ box-shadow: 0 8px 22px rgba(213, 255, 154,0.10), 0 0 0 rgba(213, 255, 154,0); }
}
 
@keyframes btn-press{
  0%{ transform: scale(1.02); }
  50%{ transform: scale(0.98); }
 100%{ transform: scale(1); }
}

.header-actions, .card {
  min-width: 0;
  max-width: 100%;
}
/* small-screen media queries removed — layout relies on clamp() and tokens */
</style>
</head>
<body>

<header>
  <img src="./mighty_mark_go.svg" alt="Pokémark" />
  <h1>Mächtige Pokémon</h1>
  <!--<h2>Mächtiger Suchstring</h2>-->
  <!--<p class="p-muted small">Mächtige Pokemon brauchen einen mächtigen Suchstring!</p>-->
  <div class="header-actions">
    <div id="mode-info" aria-hidden="true" lang="de">
    Füge den String in die Pokémon GO Suchleiste ein, um alle mächtigen Pokémon in deiner Sammlung zu finden.<br><br>
    Die Suchleiste von Pokémon GO erlaubt nur einfache AND-Verknüpfungen (&) und unterstützt keine Klammern oder OR-Logik (|). Jede Kombination aus Pokémon, Form und Fangalter muss daher einzeln aufgelistet werden, damit alle mächtigen Pokémon korrekt erfasst werden.<br><br>
    Mithilfe dieser disjunktiven Normalform (DNF) und einem automatischen Altersfilter entsteht ein sehr langer aber funktionaler Suchstring für mächtige Pokémon.
    </div>
    <button class="btn-clipboard" onclick="copyAndNotify(this)">Mächtiger Suchstring</button>
    <div class="card">
      <textarea id="output" readonly></textarea>
    </div>
    <button class="btn" onclick="shareSite()">Teilen</button>
    <button id="mode-info-btn" class="btn" onclick="toggleModeInfo()">Info</button>
  </div>
</header>

<script>
const TEMPLATE = `018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,110,38,78&018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,110,38,galar&018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,110,alola,78&018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,110,alola,galar&018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,galar,38,78&018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,galar,38&018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,galar,alola,78&018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,galar,alola&018,076,130,405,545,596,697,748,003,062,149,160,466,473,604,691,{{A25}}& {{A24}},40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,110,38,78& {{A24}},40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,110,38,galar& {{A24}},40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,110,alola,78& {{A24}},40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,110,alola,galar& {{A24}},40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,galar,38,78& {{A24}},40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,galar,38& {{A24}},40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,galar,alola,78& {{A24}},40,248,303,359,623,858,862,908,210,229,282,430,445,452,461,480-482,galar,alola& {{A24}},{{A25}}`;

const EVENT24_START = new Date(Date.UTC(2024, 10, 23, 0, 0, 0));
const EVENT24_END   = new Date(Date.UTC(2024, 10, 24, 23, 59, 59));

const EVENT25_START = new Date(Date.UTC(2025, 10, 15, 0, 0, 0));
const EVENT25_END   = new Date(Date.UTC(2025, 10, 16, 23, 59, 59));

const output = document.getElementById('output');
const infoBtn = document.getElementById('mode-info-btn');
const info = document.getElementById('mode-info');

function daysSince(date){
  const msPerDay = 1000*60*60*24;
  return Math.floor((Date.now() - date.getTime())/msPerDay);
}

function buildRanges(){
  const min24 = daysSince(EVENT24_END);
  const max24 = daysSince(EVENT24_START);
  const r24 = `alter${min24}-${max24}`;
  const min25 = daysSince(EVENT25_END);
  const max25 = daysSince(EVENT25_START);
  const r25 = `alter${min25}-${max25}`;
  return { range24: r24, range25: r25 };
}

function generateFinalString(){
  const { range24, range25 } = buildRanges();
  return TEMPLATE.replaceAll("{{A24}}", range24).replaceAll("{{A25}}", range25)
    .split('&').map(g => g.trim().replace(/,+/g, ',').replace(/^,|,$/g, ''))
    .filter(g => g.length > 0).join('&').replace(/\s+/g, ' ');
}

let cachedString = '';

function renderPreview(){
  if(!output) return;
  cachedString = generateFinalString();
  output.value = cachedString;
  requestAnimationFrame(() => { if(output) output.scrollTop = 0; });
}

let timer = null;

function scheduleMidnightUpdate(){
  if(timer) clearTimeout(timer);
  const now = new Date();
  const next = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 0, 0, 0, 0);
  const ms = next.getTime() - now.getTime();
  timer = setTimeout(()=>{
    renderPreview();
    scheduleMidnightUpdate();
  }, ms + 1000);
}

function toggleModeInfo(){
  if(!infoBtn || !info) return;
  const isOpen = infoBtn.getAttribute('aria-expanded') === 'true';
  setPopoverState(!isOpen);
}

function setPopoverState(open){
  if(!infoBtn || !info) return;
  infoBtn.setAttribute('aria-expanded', open);
  info.classList.toggle('open', open);
  info.setAttribute('aria-hidden', !open);
}

document.addEventListener('click', (e)=>{
  if(!info?.classList.contains('open')) return;
  if(!info.contains(e.target) && !infoBtn.contains(e.target)) setPopoverState(false);
}, {passive: true});

document.addEventListener('keydown', (e)=>{ 
  if(e.key === 'Escape' && info?.classList.contains('open')) setPopoverState(false);
});

function _setButtonState(btn, text, state){
  if(!btn) return;
  if(btn._timeout) clearTimeout(btn._timeout);
  if(!btn._origText) btn._origText = btn.innerText;
  if(!btn._origDisabled) btn._origDisabled = btn.disabled;
  
  btn.innerText = text;
  btn.classList.remove('success','error');
  if(state) btn.classList.add(state);
  btn.disabled = true;
  
  const ms = btn.classList.contains('btn-clipboard') ? 400 : 360;
  btn._timeout = setTimeout(()=>{
    btn.innerText = btn._origText;
    btn.classList.remove('success','error');
    btn.disabled = btn._origDisabled;
    delete btn._timeout;
  }, ms);
}

function copyAndNotify(btn){
  const button = btn || document.querySelector('.btn-clipboard');
  navigator.clipboard.writeText(cachedString || generateFinalString()).then(()=>{
    renderPreview();
    _setButtonState(button, '✓', 'success');
  }, ()=>{
    _setButtonState(button, 'Kopieren fehlgeschlagen', 'error');
  });
}

function shareSite(){
  if(navigator.share){
    navigator.share({ 
      title: document.title || 'Mächtiger Suchstring Generator', 
      text: 'Mächtige Pokémon brauchen einen mächtigen Suchstring!', 
      url: location.href 
    }).catch(()=>{});
  }
}

renderPreview();
scheduleMidnightUpdate();

document.addEventListener('visibilitychange', ()=>{
  if(!document.hidden){
    renderPreview();
    scheduleMidnightUpdate();
  }
});
</script>

</body>
</html>
